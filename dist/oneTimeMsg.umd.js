(function(c,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(c=typeof globalThis<"u"?globalThis:c||self,u(c.MyLib={}))})(this,(function(c){"use strict";const u=function(y){const d=new Date;console.log(y,"ran",d.getHours(),":",d.getMinutes());const l=function(t){return new Promise((e,s)=>{t?e(browser.tabs.query(t)):s(new Error("tab querying failed"))})},g=async function(t){const{message:e,errorCb:s,successCb:o}=t;try{const n=await browser.runtime.sendMessage(e);o(n)}catch(n){s(n.message||n)}};return{messageBackgroundScript:g,messagePopupScript:g,messageContentScript:async function(t){const{tabQueryProps:e,message:s,errorCb:o,successCb:n}=t;try{if(!e)throw new Error("tabQueryProps is undefined");const a=await l(e),i=a.length>0?a[0].id:null;if(!i){o(new Error("no valid tab found"));return}const r=await browser.tabs.sendMessage(i,s);n(r)}catch(a){o(a)}},onMessageSync:function(t){const{validateMessage:e,validateSender:s,reply:o="default reply"}=t,n=function(a,i,r){return e&&!e(a)?(r({status:"fail",error:"validateMessage failed"}),!1):s&&!s(i)?(r({status:"fail",error:"validateSender failed"}),!1):(r({status:"ok",data:o}),!1)};browser.runtime.onMessage.addListener(n)},onMessageAsync:function(t){const{validateMessage:e,validateSender:s,onAsyncCb:o}=t,n=function(a,i,r){return e&&!e(a)?(r?.({isPassed:!1,response:"validateMessage failed"}),!1):s&&!s(i)?(r?.({isPassed:!1,response:"validateSender failed"}),!1):((async function(){try{const f=await o?.(a,i);r?.({isPassed:!0,data:f,response:"async success"})}catch(f){r?.({isPassed:!1,response:f?.message??"async error"})}})(),!0)};browser.runtime.onMessage.addListener(n)},getTabsFn:l}};c.oneTimeMsgFactory=u,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})}));
