(function(u,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(u=typeof globalThis<"u"?globalThis:u||self,c(u.MyLib={}))})(this,(function(u){"use strict";const c=function(m){const g=new Date;console.log(m||"unknown-script","ran",g.getHours(),":",g.getMinutes());const l=function(t){return new Promise((e,s)=>{t?e(browser.tabs.query(t)):s(new Error("tab querying failed"))})};async function d(t){const{message:e,errorCb:s,successCb:o}=t;try{const n=await browser.runtime.sendMessage(e);o({status:!0,data:n})}catch(n){s({status:!1,message:n.message??"message to background script failed"})}}return{messageBackgroundScript:d,messagePopupScript:d,messageContentScript:async function(t){const{tabQueryProps:e,message:s,errorCb:o,successCb:n}=t;try{if(!e)throw new Error("tabQueryProps is undefined");const r=await l(e),i=r.length>0?r[0].id:null;if(!i){o({status:!1,message:"no tabs found"});return}const a=await browser.tabs.sendMessage(i,s);n({status:!0,data:a})}catch(r){o({status:!1,message:r.message??"unknown tab querying error"})}},onMessageSync:function(t){const{validateMessage:e,validateSender:s,replyCb:o=function(){return"default reply"}}=t,n=function(r,i,a){return e&&!e(r)?(a({status:!1,message:"validateMessage failed"}),!1):s&&!s(i)?(a({status:!1,message:"validateSender failed"}),!1):(a({status:!0,data:o}),!1)};browser.runtime.onMessage.addListener(n)},onMessageAsync:function(t){const{validateMessage:e,validateSender:s,onAsyncCb:o}=t,n=function(r,i,a){return e&&!e(r)?(a?.({status:!1,message:"validateMessage failed"}),!1):s&&!s(i)?(a?.({status:!1,message:"validateSender failed"}),!1):((async function(){try{const f=await o?.(r,i);if(!f)throw new Error("onMessageAsync request returned a falsy value");a?.({status:!0,data:f,message:"onMessageAsync success"})}catch(f){a?.({status:!1,message:f?.message??"onMessageAsync returned an error"})}})(),!0)};browser.runtime.onMessage.addListener(n)},getTabsFn:l}};u.oneTimeMsgFactory=c,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})}));
